import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.linear_model import LinearRegression
import warnings
import statsmodels.api as sm
from statsmodels.formula.api import ols

warnings.filterwarnings('ignore', category=UserWarning, module='seaborn.utils')

df = pd.read_csv('stress_factor.csv')

print("Original column names:")
print(df.columns)

df = df.rename(columns={
    'Kindly Rate your Sleep Quality üò¥':               'sleep_quality',
    'How many times a week do you suffer headaches ü§ï?': 'headaches',
    'How would you rate you academic performance üë©‚Äçüéì?': 'academic_perf',
    'how would you rate your study load?':            'study_load',
    'How many times a week you practice extracurricu...': 'extracurricular',
    'How would you rate your stress levels?':        'stress_levels'
})

corr = df.corr()
print("\nCorrelation matrix:")
print(corr)

plt.figure(figsize=(10, 8))
sns.heatmap(corr, annot=True, fmt=".2f", cmap="coolwarm", linewidths=.5)
plt.title('Correlation Heatmap')
plt.show()

X = df[['study_load', 'sleep_quality']]
y = df['stress_levels']
model = LinearRegression().fit(X, y)

print("\nLinear regression coefficients:")
print("study_load coefficient :", model.coef_[0])
print("sleep_quality coefficient:", model.coef_[1])
print("Intercept :", model.intercept_)

df['load_group'] = pd.qcut(df['study_load'], q=3, labels=['low', 'medium', 'high'])
anova_model = ols('stress_levels ~ load_group', data=df).fit()
anova_table = sm.stats.anova_lm(anova_model, typ=2)

print("\nOne‚Äëway ANOVA (stress_levels by study_load group):")
print(anova_table)

plt.figure(figsize=(6, 4))
sns.boxplot(x='load_group', y='stress_levels', data=df)
plt.title('Stress Levels by Study Load Group')
plt.show()
