import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.linear_model import LinearRegression
import warnings
import statsmodels.api as sm
from statsmodels.formula.api import ols

warnings.filterwarnings('ignore', category=UserWarning, module='seaborn.utils')

df = pd.read_csv('stress_factor.csv')
print("Original columns:")
print(df.columns)

df = df.rename(columns={
    'Kindly Rate your Sleep Quality üò¥':               'sleep_quality',
    'How many times a week do you suffer headaches ü§ï?': 'headaches',
    'How would you rate you academic performance üë©‚Äçüéì?': 'academic_perf',
    'how would you rate your study load?':            'study_load',
    'How many times a week you practice extracurricular activities üéæ?': 'extracurricular',
    'How would you rate your stress levels?':        'stress_levels'
})

corr = df.corr()
print("\nCorrelation matrix:")
print(corr)

plt.figure(figsize=(10, 8))
sns.heatmap(corr, annot=True, fmt=".2f", cmap="coolwarm", linewidths=.5)
plt.title('Correlation Heatmap')
plt.show()

predictors = ['sleep_quality', 'headaches', 'academic_perf',
              'study_load', 'extracurricular']
X = df[predictors]
y = df['stress_levels']

model = LinearRegression().fit(X, y)

print("\nMultiple Linear Regression Coefficients:")
for col, coef in zip(predictors, model.coef_):
    print(f"{col}: {coef:.4f}")
print("Intercept:", model.intercept_)

# 6‚Äëway ANOVA (one for each predictor)
for var in predictors:
    formula = f"stress_levels ~ {var}"
    anova = ols(formula, data=df).fit()
    table = sm.stats.anova_lm(anova, typ=2)
    print(f"\nANOVA for {var}:")
    print(table)

